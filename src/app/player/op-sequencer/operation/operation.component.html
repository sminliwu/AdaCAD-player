<div class="operation-container">

  <!-- <div class="top-row" >

    <div class="operation-details">
      <div class="name">{{op.name}}</div>
      <button 
      class="help">
        <i class="fas fa-question"></i>
      </button> 
    </div>
      
  </div>     -->

  <div *ngIf="is_selected; else notSelected">
    <div *ngIf="op.chain_check == 1 || op.custom_check == 1; else notChain">
      <div *ngIf="op.chain_check == 1">
        <button 
        [name] = op.name
        class="selected-operation-box"  
        [matMenuTriggerFor]="seqChainMenu">
          <mat-icon svgIcon="op-chain" aria-hidden="false" aria-label="icon for chain operation"></mat-icon>
          {{op.name}}
        </button>
      </div>
      <div *ngIf="op.custom_check == 1">
        <button 
        [name] = op.name
        class="selected-operation-box"  
        [matMenuTriggerFor]="seqMenu">
          <mat-icon svgIcon="op-custom" aria-hidden="false" aria-label="icon for custom operation"></mat-icon>
          {{op.name}}
        </button>
      </div>
    </div>
    
    <ng-template #notChain>
      <button 
      [name] = op.name
      class="selected-operation-box"  
      [matMenuTriggerFor]="seqMenu">
        <mat-icon svgIcon="op-{{op.name}}" aria-hidden="false" aria-label="icon for {{op.name}} operation"></mat-icon>
        {{op.name}}
      </button>
    </ng-template>
  </div>
  
  <ng-template #notSelected>
    <div *ngIf="op.chain_check == 1 || op.custom_check == 1; else notChain">
      <div *ngIf="op.chain_check == 1">
        <button 
        [name] = op.name
        class="operation-box"  
        [matMenuTriggerFor]="seqChainMenu">
          <mat-icon svgIcon="op-chain" aria-hidden="false" aria-label="icon for chain operation"></mat-icon>
          {{op.name}}
        </button>
      </div>
      <div *ngIf="op.custom_check == 1">
        <button 
        [name] = op.name
        class="operation-box"  
        [matMenuTriggerFor]="seqMenu">
          <mat-icon svgIcon="op-custom" aria-hidden="false" aria-label="icon for custom operation"></mat-icon>
          {{op.name}}
        </button>
      </div>
    </div>
    
    <ng-template #notChain>
      <button 
      [name] = op.name
      class="operation-box"  
      [matMenuTriggerFor]="seqMenu">
        <mat-icon svgIcon="op-{{op.name}}" aria-hidden="false" aria-label="icon for {{op.name}} operation"></mat-icon>
        {{op.name}}
      </button>
    </ng-template>
  </ng-template>

  <mat-menu #seqMenu="matMenu">
    <div class="sub-menu">
      <button mat-stroked-menu-item
        class="sub-menu-button"
        (click) ="shift(false)">
        Shift Left
      </button>

      <button mat-stroked-menu-item
        class="sub-menu-button"
        (click) ="shift(true)">
        Shift Right
      </button>
      
      <button mat-stroked-menu-item
        class="sub-menu-button"
        (click) ="delete()">
        Remove from Sequencer
      </button>

      <ng-container *ngFor="let param of op.params; let i = index">
        <ng-container  *ngIf="param.type === 'number'">
          <mat-form-field>
            <mat-label class="param-name">{{param.name}}</mat-label>
            <input 
              matInput
              id = "param-{{op.id}}-{{i}}"
              [matTooltip] = param.dx
              type = "number"
              [name]= param.name
              [min]= param.min
              [max]= param.max
              [(value)] = param.value
              (change)="updateParam($event.target.id, $event.target.value)"
              step = 1
            >
          </mat-form-field>
        </ng-container>
      </ng-container>  
    </div>
  </mat-menu>
</div>  
